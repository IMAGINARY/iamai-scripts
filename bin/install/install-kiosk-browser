#!/usr/bin/env bash

if [ "$UID" -ne 0 ]
then
    >&2 echo "This script requires superuser priviledges."
    exit 1
fi

# Install kiosk browser
KIOSK_BROWSER_VERSION="0.13.0-beta.0"
KIOSK_BROWSER_VERSION_INSTALLED=$(dpkg-query --showformat='${Version} ${Status}' --show kiosk-browser 2> /dev/null | awk '$NF == "installed"{print $1}')
if [ "$KIOSK_BROWSER_VERSION" = "$KIOSK_BROWSER_VERSION_INSTALLED" ]
then
    echo "kiosk-browser v$KIOSK_BROWSER_VERSION already installed"
else
    # Now install the kiosk-browser package
    TEMP_DEB="$(mktemp --suffix .deb)"
    wget -O "$TEMP_DEB" "https://github.com/IMAGINARY/kiosk-browser/releases/download/v"$KIOSK_BROWSER_VERSION"/kiosk-browser_"$KIOSK_BROWSER_VERSION"_amd64.deb"
    apt install "$TEMP_DEB"
    rm -f "$TEMP_DEB"
fi
